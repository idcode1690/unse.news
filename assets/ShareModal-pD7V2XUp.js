import{r as n,a as W,j as e}from"./index-DEUf_PyA.js";import{B as S}from"./cookieUtils-B8spcfGc.js";function $({isOpen:a,onClose:i,pageTitle:l="운세뉴스",shareText:s="유용했다면 지인에게 공유해보세요!"}){const y=n.useRef(null),c=n.useRef(null),m=n.useRef(null),h=n.useRef(null),b=n.useRef(""),x=()=>{const{origin:o,pathname:r}=window.location;return`${o}${r}#/`},f=()=>{try{i==null||i()}catch{}},j=o=>{o.target===y.current&&f()},v=()=>{try{window.location.hash="#/"}finally{f()}},R=async()=>{const o=x();if(navigator.share){try{await navigator.share({title:l,text:s,url:o})}catch{}v();return}try{await navigator.clipboard.writeText(o),alert("홈 링크를 클립보드에 복사했습니다.")}catch{try{const r=document.createElement("textarea");r.value=o,r.setAttribute("readonly",""),r.style.position="fixed",r.style.opacity="0",document.body.appendChild(r),r.select(),document.execCommand("copy"),document.body.removeChild(r),alert("홈 링크를 클립보드에 복사했습니다.")}catch{}}finally{v()}};if(n.useEffect(()=>{if(!a)return;try{document.body.classList.remove("scroll-lock")}catch{}b.current=document.body.style.overflow||"",document.body.style.overflow="hidden",h.current=document.activeElement;const o=setTimeout(()=>{var t;return(t=m.current||c.current)==null?void 0:t.focus()},0),r=t=>{var d;if(t.key==="Escape"&&(t.preventDefault(),f()),t.key==="Tab"){const u=K(c.current);if(!u.length){t.preventDefault(),(d=c.current)==null||d.focus();return}const w=u[0],k=u[u.length-1];t.shiftKey&&document.activeElement===w?(t.preventDefault(),k.focus()):!t.shiftKey&&document.activeElement===k&&(t.preventDefault(),w.focus())}};return window.addEventListener("keydown",r),()=>{var t,d;clearTimeout(o),window.removeEventListener("keydown",r),document.body.style.overflow=b.current||"";try{(d=(t=h.current)==null?void 0:t.focus)==null||d.call(t)}catch{}}},[a]),!a)return null;const p=(()=>{try{return window.matchMedia("(prefers-reduced-motion: reduce)").matches}catch{return!1}})(),I={position:"fixed",inset:0,zIndex:1e3,background:"color-mix(in oklab, black 38%, transparent)",display:"grid",placeItems:"center",padding:16,backdropFilter:"blur(2px)",animation:p?void 0:"fadeIn .16s ease-out"},E={width:"min(560px, 94vw)",background:"var(--surface, #fff)",color:"var(--ink, #111827)",border:"1px solid var(--border, #e5e7eb)",borderRadius:16,boxShadow:"0 20px 48px rgba(0,0,0,.16)",overflow:"hidden",outline:"none",display:"grid",gridTemplateRows:"auto 1fr auto",transform:p?"none":"translateY(6px)",animation:p?void 0:"popIn .18s ease-out"},C={padding:"16px 18px 12px",borderBottom:"1px solid var(--border, #e5e7eb)",display:"flex",alignItems:"center",gap:12},M={width:36,height:36,flex:"0 0 36px",display:"grid",placeItems:"center",borderRadius:12,color:"#fff",background:"linear-gradient(135deg, var(--accent, #7a5af8), #0fa958)",boxShadow:"0 6px 20px rgba(122,90,248,.25)",fontSize:18,fontWeight:800},z={display:"grid",gap:4},T={margin:0,fontSize:18,fontWeight:800,lineHeight:1.25},B={margin:0,fontSize:13,color:"var(--ink-soft, #6b7280)"},D={padding:18,display:"grid",gap:12},F={padding:12,border:"1px solid var(--border, #e5e7eb)",borderRadius:12,background:"var(--surface, #fff)",fontSize:14,color:"var(--ink, #374151)",lineHeight:1.6},L={display:"flex",alignItems:"center",gap:8,padding:10,borderRadius:10,border:"1px dashed var(--border, #e5e7eb)",background:"color-mix(in oklab, var(--surface, #fff) 92%, #7a5af8 8%)",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',overflow:"hidden"},A={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:13,opacity:.9},H={padding:14,borderTop:"1px solid var(--border, #e5e7eb)",display:"flex",justifyContent:"flex-end",gap:8,background:"var(--surface, #fff)"},g=x(),U=e.jsxs("div",{ref:y,style:I,onClick:j,"data-testid":"share-backdrop",children:[e.jsxs("div",{ref:c,role:"dialog","aria-modal":"true","aria-labelledby":"share-title","aria-describedby":"share-desc",style:E,tabIndex:-1,onClick:o=>o.stopPropagation(),"data-testid":"share-modal",children:[e.jsxs("div",{style:C,children:[e.jsx("div",{style:M,"aria-hidden":!0,children:"🔗"}),e.jsxs("div",{style:z,children:[e.jsx("h3",{id:"share-title",style:T,children:"공유하기"}),e.jsx("p",{style:B,children:"친구/가족에게 운세뉴스를 알려보세요"})]})]}),e.jsxs("div",{style:D,children:[e.jsxs("div",{id:"share-desc",style:F,children:[e.jsx("strong",{style:{fontWeight:800},children:l}),e.jsx("div",{style:{marginTop:6},children:s})]}),e.jsxs("div",{style:L,"aria-label":"공유 링크",children:[e.jsx("span",{style:{opacity:.6},children:"URL"}),e.jsx("span",{style:A,title:g,children:g})]})]}),e.jsxs("div",{style:H,children:[e.jsx(S,{variant:"text",onClick:f,ref:m,"data-testid":"share-cancel",children:"다음에"}),e.jsx(S,{onClick:R,"data-testid":"share-confirm",children:"공유하기"})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
        @keyframes popIn {
          from { opacity: .001; transform: translateY(10px) scale(.98) }
          to   { opacity: 1;    transform: translateY(0)  scale(1) }
        }
        @media (prefers-reduced-motion: reduce){
          @keyframes fadeIn { from { opacity: 1 } to { opacity: 1 } }
          @keyframes popIn  { from { transform:none } to { transform:none } }
        }
      `})]});return W.createPortal(U,document.body)}function K(a){if(!a)return[];const i=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",");return Array.from(a.querySelectorAll(i)).filter(l=>{const s=window.getComputedStyle(l);return s.display!=="none"&&s.visibility!=="hidden"})}export{$ as S};
