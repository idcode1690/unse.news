import{a as U,r as n,j as e}from"./index-Wku8L6wJ.js";import{B as k}from"./index-BSTa-Vbb.js";var W=U();function P({isOpen:a,onClose:f,pageTitle:s="운세뉴스",shareText:i="유용했다면 지인에게 공유해보세요!"}){const p=n.useRef(null),d=n.useRef(null),y=n.useRef(null),m=n.useRef(null),h=n.useRef(""),b=()=>{const{origin:r,pathname:t}=window.location;return`${r}${t}#/`},l=()=>{try{f?.()}catch{}},S=r=>{r.target===p.current&&l()},x=()=>{try{window.location.hash="#/"}finally{l()}},j=async()=>{const r=b();if(navigator.share){try{await navigator.share({title:s,text:i,url:r})}catch{}x();return}try{await navigator.clipboard.writeText(r),alert("홈 링크를 클립보드에 복사했습니다.")}catch{try{const t=document.createElement("textarea");t.value=r,t.setAttribute("readonly",""),t.style.position="fixed",t.style.opacity="0",document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t),alert("홈 링크를 클립보드에 복사했습니다.")}catch{}}finally{x()}};if(n.useEffect(()=>{if(!a)return;try{document.body.classList.remove("scroll-lock")}catch{}h.current=document.body.style.overflow||"",document.body.style.overflow="hidden",m.current=document.activeElement;const r=setTimeout(()=>(y.current||d.current)?.focus(),0),t=o=>{if(o.key==="Escape"&&(o.preventDefault(),l()),o.key==="Tab"){const c=K(d.current);if(!c.length){o.preventDefault(),d.current?.focus();return}const g=c[0],w=c[c.length-1];o.shiftKey&&document.activeElement===g?(o.preventDefault(),w.focus()):!o.shiftKey&&document.activeElement===w&&(o.preventDefault(),g.focus())}};return window.addEventListener("keydown",t),()=>{clearTimeout(r),window.removeEventListener("keydown",t),document.body.style.overflow=h.current||"";try{m.current?.focus?.()}catch{}}},[a]),!a)return null;const u=(()=>{try{return window.matchMedia("(prefers-reduced-motion: reduce)").matches}catch{return!1}})(),R={position:"fixed",inset:0,zIndex:1e3,background:"color-mix(in oklab, black 38%, transparent)",display:"grid",placeItems:"center",padding:16,backdropFilter:"blur(2px)",animation:u?void 0:"fadeIn .16s ease-out"},C={width:"min(560px, 94vw)",background:"var(--surface, #fff)",color:"var(--ink, #111827)",border:"1px solid var(--border, #e5e7eb)",borderRadius:16,boxShadow:"0 20px 48px rgba(0,0,0,.16)",overflow:"hidden",outline:"none",display:"grid",gridTemplateRows:"auto 1fr auto",transform:u?"none":"translateY(6px)",animation:u?void 0:"popIn .18s ease-out"},I={padding:"16px 18px 12px",borderBottom:"1px solid var(--border, #e5e7eb)",display:"flex",alignItems:"center",gap:12},E={width:36,height:36,flex:"0 0 36px",display:"grid",placeItems:"center",borderRadius:12,color:"#fff",background:"linear-gradient(135deg, var(--accent, #7a5af8), #0fa958)",boxShadow:"0 6px 20px rgba(122,90,248,.25)",fontSize:18,fontWeight:800},M={display:"grid",gap:4},z={margin:0,fontSize:18,fontWeight:800,lineHeight:1.25},D={margin:0,fontSize:13,color:"var(--ink-soft, #6b7280)"},T={padding:18,display:"grid",gap:12},B={padding:12,border:"1px solid var(--border, #e5e7eb)",borderRadius:12,background:"var(--surface, #fff)",fontSize:14,color:"var(--ink, #374151)",lineHeight:1.6},F={display:"flex",alignItems:"center",gap:8,padding:10,borderRadius:10,border:"1px dashed var(--border, #e5e7eb)",background:"color-mix(in oklab, var(--surface, #fff) 92%, #7a5af8 8%)",fontFamily:'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace',overflow:"hidden"},L={whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",fontSize:13,opacity:.9},A={padding:14,borderTop:"1px solid var(--border, #e5e7eb)",display:"flex",justifyContent:"flex-end",gap:8,background:"var(--surface, #fff)"},v=b(),H=e.jsxs("div",{ref:p,style:R,onClick:S,"data-testid":"share-backdrop",children:[e.jsxs("div",{ref:d,role:"dialog","aria-modal":"true","aria-labelledby":"share-title","aria-describedby":"share-desc",style:C,tabIndex:-1,onClick:r=>r.stopPropagation(),"data-testid":"share-modal",children:[e.jsxs("div",{style:I,children:[e.jsx("div",{style:E,"aria-hidden":!0,children:"🔗"}),e.jsxs("div",{style:M,children:[e.jsx("h3",{id:"share-title",style:z,children:"공유하기"}),e.jsx("p",{style:D,children:"친구/가족에게 운세뉴스를 알려보세요"})]})]}),e.jsxs("div",{style:T,children:[e.jsxs("div",{id:"share-desc",style:B,children:[e.jsx("strong",{style:{fontWeight:800},children:s}),e.jsx("div",{style:{marginTop:6},children:i})]}),e.jsxs("div",{style:F,"aria-label":"공유 링크",children:[e.jsx("span",{style:{opacity:.6},children:"URL"}),e.jsx("span",{style:L,title:v,children:v})]})]}),e.jsxs("div",{style:A,children:[e.jsx(k,{variant:"text",onClick:l,ref:y,"data-testid":"share-cancel",children:"다음에"}),e.jsx(k,{onClick:j,"data-testid":"share-confirm",children:"공유하기"})]})]}),e.jsx("style",{children:`
        @keyframes fadeIn { from { opacity: 0 } to { opacity: 1 } }
        @keyframes popIn {
          from { opacity: .001; transform: translateY(10px) scale(.98) }
          to   { opacity: 1;    transform: translateY(0)  scale(1) }
        }
        @media (prefers-reduced-motion: reduce){
          @keyframes fadeIn { from { opacity: 1 } to { opacity: 1 } }
          @keyframes popIn  { from { transform:none } to { transform:none } }
        }
      `})]});return W.createPortal(H,document.body)}function K(a){if(!a)return[];const f=["a[href]","button:not([disabled])","textarea:not([disabled])","input:not([disabled])","select:not([disabled])",'[tabindex]:not([tabindex="-1"])'].join(",");return Array.from(a.querySelectorAll(f)).filter(s=>{const i=window.getComputedStyle(s);return i.display!=="none"&&i.visibility!=="hidden"})}export{P as S};
