import{n as K,o as $,p as Y}from"./cookieUtils-DJ3Vlisv.js";const j={甲:"목",乙:"목",丙:"화",丁:"화",戊:"토",己:"토",庚:"금",辛:"금",壬:"수",癸:"수"},k={子:"수",丑:"토",寅:"목",卯:"목",辰:"토",巳:"화",午:"화",未:"토",申:"금",酉:"금",戌:"토",亥:"수"},L={子:[{stem:"壬",w:1}],丑:[{stem:"己",w:.5},{stem:"癸",w:.3},{stem:"辛",w:.2}],寅:[{stem:"甲",w:.6},{stem:"丙",w:.3},{stem:"戊",w:.1}],卯:[{stem:"乙",w:1}],辰:[{stem:"戊",w:.5},{stem:"乙",w:.3},{stem:"癸",w:.2}],巳:[{stem:"丙",w:.6},{stem:"庚",w:.3},{stem:"戊",w:.1}],午:[{stem:"丁",w:.7},{stem:"己",w:.3}],未:[{stem:"己",w:.5},{stem:"丁",w:.3},{stem:"乙",w:.2}],申:[{stem:"庚",w:.7},{stem:"壬",w:.2},{stem:"戊",w:.1}],酉:[{stem:"辛",w:1}],戌:[{stem:"戊",w:.6},{stem:"辛",w:.3},{stem:"丁",w:.1}],亥:[{stem:"壬",w:.7},{stem:"甲",w:.3}]},P=[["子","午"],["丑","未"],["寅","申"],["卯","酉"],["辰","戌"],["巳","亥"]],B=[["子","未"],["丑","午"],["寅","巳"],["卯","辰"],["申","亥"],["酉","戌"]],z=[["子","卯"],["丑","戌"],["寅","亥"],["卯","子"],["辰","丑"],["巳","申"],["午","酉"],["未","辰"],["申","巳"],["酉","午"],["戌","未"],["亥","寅"]],q=[["寅","巳","申"],["丑","戌","未"]],J=["辰","午","酉","子"],U=[{set:["亥","卯","未"],element:"목"},{set:["寅","午","戌"],element:"화"},{set:["巳","酉","丑"],element:"금"},{set:["申","子","辰"],element:"수"}],W=[{set:["亥","子","丑"],element:"수"},{set:["寅","卯","辰"],element:"목"},{set:["巳","午","未"],element:"화"},{set:["申","酉","戌"],element:"금"}],m=["목","화","토","금","수"],R=(t,e)=>m[(m.indexOf(t)+1)%5]===e,Q=(t,e)=>R(e,t),G=(t,e)=>m[(m.indexOf(t)+2)%5]===e,V=(t,e)=>G(e,t),A=t=>(t??"").toString().trim(),E=t=>j[A(t)]||null,I=t=>k[A(t)]||null,X=t=>Array.from(new Set(t));function Z(t,e={includeHidden:!0}){const n={목:0,화:0,토:0,금:0,수:0},s=(a,i=1)=>{n[a]!=null&&(n[a]+=i)},c=[t?.year,t?.month,t?.day,t?.hour].filter(Boolean);return c.forEach(a=>{const i=E(a.stem);i&&s(i,1)}),c.forEach(a=>{const i=I(a.branch);i&&s(i,.8)}),e.includeHidden&&c.forEach(a=>{(L[A(a.branch)]||[]).forEach(({stem:f,w:u})=>{const l=E(f);l&&s(l,u*.5)})}),n}function tt(t){const e=E(t?.day?.stem);if(!e)return{score:0,level:"불명",rationale:"일간 미확인"};const n=Z(t,{includeHidden:!0}),s=n[e]||0,c=m[(m.indexOf(e)+4)%5],a=m[(m.indexOf(e)+1)%5],i=m[(m.indexOf(e)+2)%5],f=m[(m.indexOf(e)+3)%5],u=n[c]||0,l=n[a]||0,y=n[i]||0,o=n[f]||0,r=t?.month?.branch,w=["寅","卯","辰"].includes(r)?"봄":["巳","午","未"].includes(r)?"여름":["申","酉","戌"].includes(r)?"가을":"겨울",p={봄:"목",여름:"화",가을:"금",겨울:"수"}[w]===e?.4:0,g=s*1+u*.7+l*.2+p-y*.6-o*.3;let S="중간";g>=2.8?S="신강":g<=1.8&&(S="신약");const b=`일간(${e}) 동류=${s.toFixed(1)}, 인성=${u.toFixed(1)}, 식상=${l.toFixed(1)}, 관살=${y.toFixed(1)}, 재성=${o.toFixed(1)}, 계절보정=${p.toFixed(1)} → 점수=${g.toFixed(2)}`;return{score:g,level:S,rationale:b,counts:n,monthGroup:w}}function et(t){const e=X([t?.year?.branch,t?.month?.branch,t?.day?.branch,t?.hour?.branch].filter(Boolean)),n=(o,r)=>e.includes(o)&&e.includes(r),s=o=>o.every(r=>e.includes(r)),c=U.filter(o=>s(o.set)).map(o=>({type:"삼합",set:o.set,element:o.element})),a=W.filter(o=>s(o.set)).map(o=>({type:"방합",set:o.set,element:o.element})),i=P.filter(([o,r])=>n(o,r)).map(([o,r])=>({type:"충",pair:[o,r]})),f=B.filter(([o,r])=>n(o,r)).map(([o,r])=>({type:"해",pair:[o,r]})),u=z.filter(([o,r])=>n(o,r)).map(([o,r])=>({type:"파",pair:[o,r]})),l=[];q.forEach(o=>{s(o)&&l.push({type:"형(삼형)",set:o})}),J.forEach(o=>{e.filter(w=>w===o).length>=2&&l.push({type:"형(자형)",pair:[o,o]})});const y=B.filter(([o,r])=>n(o,r)).map(([o,r])=>({type:"원진",pair:[o,r]}));return{samhap:c,banghap:a,chong:i,hae:f,pa:u,hyeong:l,wonjin:y}}function nt(t){const e=E(t?.day?.stem),n=I(t?.month?.branch);if(!e||!n)return{type:"불명",basis:"일간/월지 확인 불가"};let s="잡격";return n===e?s="비견격":Q(e,n)?s="인수격":R(e,n)?s="식상격":V(e,n)?s="관살격":G(e,n)&&(s="재격"),{type:s,basis:`월지(${t?.month?.branch}:${n}) vs 일간(${e}) 관계`}}function ot(t,e){const n=E(t?.day?.stem);if(!n)return{flow:[],temperature:[],notes:[]};const s=t?.month?.branch,c=["寅","卯","辰"].includes(s)?"봄":["巳","午","未"].includes(s)?"여름":["申","酉","戌"].includes(s)?"가을":"겨울",a=m[(m.indexOf(n)+4)%5],i=m[(m.indexOf(n)+2)%5],f=m[(m.indexOf(n)+3)%5],u=e?.level==="신약"?[n,a]:e?.level==="신강"?[i,f]:[n,i],l=c==="겨울"?["화"]:c==="여름"?["수"]:c==="봄"?["금","수"]:["목","수"],y=[`계절=${c}, 일간=${n}, 신강도=${e?.level||"불명"}`,`순환용신(휴리스틱)=${u.join(", ")}`,`조후용신(근사)=${l.join(", ")}`];return{flow:u,temperature:l,notes:y}}const st=new Set(["甲","丙","戊","庚","壬"]);function ct(t){return st.has(t)}function rt(t,e){const n=Y.indexOf(t),s=$.indexOf(e);if(n<0||s<0)return-1;for(let c=0;c<60;c++)if(c%10===n&&c%12===s)return c;return-1}function at(t){const e=t%60%10,n=t%60%12;return{stem:Y[e],branch:$[n]}}const it=["소한","입춘","경칩","청명","입하","망종","소서","입추","백로","한로","입동","대설"];function H(t){const e={};K.forEach(s=>{e[s.name]={month:s.month,day:s.approxDay}});const n=[];for(const s of it){const c=e[s];c&&n.push({name:s,date:new Date(t,c.month-1,c.day,0,0,0)})}return n}function mt(t,e){return(e-t)/(1e3*60*60*24)}function lt(t,e){if(!t?.month||!t?.year)return{direction:"불명",start:{years:0,months:0,days:0},list:[]};const n=new Date(e.y,(e.m||1)-1,e.d,e.hh||0,e.mm||0,0),s=e.gender!=="female",c=e.yearStem||t.year.stem,a=ct(c),i=s&&a||!s&&!a,f=i?"순행":"역행",u=i?1:-1,l=n.getFullYear(),y=H(l),o=H(l+1),r=H(l-1);let w=null;if(i)w=[...y,...o].map(h=>h.date).find(h=>h.getTime()>n.getTime())||o[0]?.date;else{const d=[...r,...y].map(h=>h.date).filter(h=>h.getTime()<n.getTime());w=d[d.length-1]||r[r.length-1]?.date}w||(w=new Date(l,n.getMonth(),n.getDate()+5));const D=Math.max(0,Math.round(mt(n,w))),p=D*4,g=Math.floor(p/12),S=p%12,b=rt(t.month.stem,t.month.branch),N=[],C=8;for(let d=1;d<=C;d++){const h=(b+u*d+60)%60,F=at(h),M=g+(d-1)*10,x=M+9;N.push({order:d,pillar:F,ageStart:M,ageEnd:x})}let T=null;try{const d=new Date(n.getTime()),h=d.getFullYear(),F=d.getMonth(),M=d.getDate(),x=new Date(h,F+p,M);T=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`}catch{}return{direction:f,start:{years:g,months:S,days:D},startDate:T,list:N}}const ut=["갑","을","병","정","무","기","경","신","임","계"],dt=["자","축","인","묘","진","사","오","미","신","유","술","해"];function O(t){let e=(t-1984)%60;return e<0&&(e+=60),e}function v(t){return{stem:ut[t%10],branch:dt[t%12]}}function _(t){const e=t%60%10,n=t%60%12;return{stem:Y[e],branch:$[n]}}function ft(t=new Date().getFullYear(),e=10){const n=[];for(let s=0;s<e;s++){const c=t+s,a=O(c);n.push({year:c,pillarKor:v(a),pillarHan:_(a)})}return{currentYear:t,currentKor:v(O(t)),currentHan:_(O(t)),list:n}}function wt(t,e={}){const n=tt(t),s=et(t),c=nt(t),a=ot(t,n);let i=null;e.birth&&e.birth.y&&(i=lt(t,e.birth));const f=new Date().getFullYear(),u=ft(f,10);return{counts:n.counts,strength:{score:Number(n.score?.toFixed?.(2)??n.score),level:n.level,rationale:n.rationale,monthGroup:n.monthGroup},relations:s,geoguk:c,yongshin:a,daewoon:i,sewoon:u}}function yt(t){return E(t)}export{wt as a,Z as c,yt as g,tt as i};
