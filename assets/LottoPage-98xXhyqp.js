import{r as x,j as r,I as ae}from"./index-XpcX2Vby.js";import{s as ce,b as J,a as de,g as ue,i as he,P as Q,c as re,l as pe}from"./seo-Dz25LcOt.js";import{a as me,i as V,j as X}from"./index-BXLhSbu3.js";import{S as fe}from"./ShareModal-CexRBAA7.js";function A(e){return String(e).padStart(2,"0")}function b(e){const t=Number(e);return Number.isFinite(t)?t.toFixed(2):"0.00"}function ne(){const e=new Date(Date.now()+324e5);return{y:e.getUTCFullYear(),m:e.getUTCMonth()+1,d:e.getUTCDate()}}function xe(){const e=ne();return`${e.y}-${A(e.m)}-${A(e.d)}`}const ge=120,be=.6;function ye(e){let t=2166136261;for(let o=0;o<e.length;o++)t^=e.charCodeAt(o),t=Math.imul(t,16777619);return t>>>0}function je(e){return function(){let t=(e+=1831565813)>>>0;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}}const L={목:Array.from({length:9},(e,t)=>1+t),화:Array.from({length:9},(e,t)=>10+t),토:Array.from({length:9},(e,t)=>19+t),금:Array.from({length:9},(e,t)=>28+t),수:Array.from({length:9},(e,t)=>37+t)},k=["목","화","토","금","수"],we=e=>k[(k.indexOf(e)+4)%5],Z=e=>k[(k.indexOf(e)+1)%5],ve=e=>k[(k.indexOf(e)+2)%5],ee=e=>k[(k.indexOf(e)+3)%5];function U(e){if(e===""||e===null||e===void 0)return null;const t=Number(e);return Number.isFinite(t)&&t>=0&&t<=23?t:null}function Ee(e){if(!e)return null;if(e?.sajuResult?.year&&e?.sajuResult?.month&&e?.sajuResult?.day&&e?.sajuResult?.hour)return e;const t=e.calendar||"solar",o=Number(e.year),n=Number(e.month),m=Number(e.day),d=U(e.hour)??12,c=Number(e.minute??0),j=e.leapMonth==="leap"||e.isLeap===!0;let s,i,f;if(typeof e.solarDate=="string"){const g=String(e.solarDate).match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);g&&(s=Number(g[1]),i=Number(g[2]),f=Number(g[3]))}if(!s||!i||!f)if(t==="lunar"){const g=pe(o,n,m,j),N=g instanceof Date?g:new Date(g);s=N.getFullYear(),i=N.getMonth()+1,f=N.getDate()}else s=o,i=n,f=m;const M=re(s,i,f,d,c);return{...e,calendar:t,solarDate:`${s}-${A(i)}-${A(f)}`,sajuResult:M,year:o,month:n,day:m,hour:e.hour??"",minute:e.minute??"0"}}function Ne(){const e=ne();return re(e.y,e.m,e.d,12,0)}function Se(e,t){const o=Object.entries(t).filter(([,d])=>d>0),n=o.reduce((d,[,c])=>d+c,0);if(!o.length||n<=0)return null;let m=e()*n;for(const[d,c]of o){if(m<c)return d;m-=c}return o[o.length-1][0]}function Te(e,t,o,n,m){const d=(e.목+e.화+e.토+e.금+e.수)/5,c={목:Math.max(0,d-(e.목||0)),화:Math.max(0,d-(e.화||0)),토:Math.max(0,d-(e.토||0)),금:Math.max(0,d-(e.금||0)),수:Math.max(0,d-(e.수||0))};if(t){const s=(i,f)=>c[i]=Math.max(0,(c[i]||0)+f);o.level==="신약"?(s(we(t),1),s(Z(t),.35),s(t,.25)):o.level==="신강"?(s(ee(t),.85),s(ve(t),.35),c[t]=Math.max(0,(c[t]||0)-.25)):(s(Z(t),.15),s(ee(t),.15))}const j=.25;if(["목","화","토","금","수"].forEach(s=>{const i=(n[s]||0)*j;c[s]=Math.max(0,(c[s]||0)+i)}),m&&m.length)for(const s of m)c[s]=Math.max(0,(c[s]||0)+.6);return c}function Oe(e){return e>=1&&e<=9?"목":e>=10&&e<=18?"화":e>=19&&e<=27?"토":e>=28&&e<=36?"금":e>=37&&e<=45?"수":""}function te(e){switch(e){case"목":return"el-wood";case"화":return"el-fire";case"토":return"el-earth";case"금":return"el-metal";case"수":return"el-water";default:return""}}function ke(e,t){const o={목:[...L.목],화:[...L.화],토:[...L.토],금:[...L.금],수:[...L.수]},n=new Set,m=[],d={},c=Object.entries(t).sort((s,i)=>i[1]-s[1]).map(([s])=>s),j={...t};for(let s=0;s<6;s++){let i=Se(e,j)||c[s%c.length];j[i]=Math.max(0,(j[i]||0)*.88);let f=null,M=0;for(;M++<16;){if(!o[i]?.length){const $=Object.keys(o).filter(I=>o[I].length>0);if(!$.length)break;i=$[Math.floor(e()*$.length)]}const g=Math.floor(e()*o[i].length),N=o[i][g];if(!n.has(N)){f=N,o[i].splice(g,1);break}}f!=null&&(n.add(f),m.push(f),d[f]=i)}return m.sort((s,i)=>s-i),{main:m,mapping:d}}const _=["목","화","토","금","수"];function Me(e){if(!e||typeof window>"u")return null;let t=e.parentElement;for(;t;){const o=window.getComputedStyle(t);if(/(auto|scroll|overlay)/.test(o.overflowY)||/(auto|scroll|overlay)/.test(o.overflow))return t;t=t.parentElement}return null}function G(e){if(e)return{scrollTop:e.scrollTop,clientHeight:e.clientHeight,scrollHeight:e.scrollHeight};const t=document.scrollingElement||document.documentElement;return{scrollTop:t.scrollTop,clientHeight:window.innerHeight||t.clientHeight,scrollHeight:t.scrollHeight}}const De=()=>{const e="로또 숫자",[t,o]=x.useState([]),[n,m]=x.useState(null),[d,c]=x.useState(null),[j,s]=x.useState(null),[i,f]=x.useState(null),[M,g]=x.useState(!1),[N,$]=x.useState(!1),I=x.useRef(null),W=x.useRef(null),C=x.useRef(!1),Y=x.useRef(0),H=x.useRef(!1),K=x.useMemo(()=>xe(),[]);return x.useEffect(()=>{ce({title:`${e} | 운세뉴스`,description:"쿠키의 생년월일과 오늘 사주를 반영해 확률 가중 추출한 6/45 숫자(5세트).",path:"/#/lotto",image:"/og-image.png"})},[]),x.useEffect(()=>{let l=null;try{l=me()}catch{}if(!!!(l&&l.year&&l.month&&l.day)){g(!0);return}g(!1);const v=Ne();s(v);const S=J(v,{includeHidden:!1}),h=Ee(l),E=h.sajuResult;c(E);const z={y:h.year,m:h.month,d:h.day,hh:U(h.hour)??12,mm:Number(h.minute??0),gender:h.gender||"unknown",yearStem:E?.year?.stem},T=de(E,{birth:z});f(T);const P=J(E,{includeHidden:!0}),O=ue(E?.day?.stem),a=he(E),w=[].concat(T?.yongshin?.primary?[T.yongshin.primary]:[]).concat(T?.yongshin?.secondary?[T.yongshin.secondary]:[]).filter(Boolean),p=Te(P,O,a,S,w),F=_.reduce((u,D)=>u+(p[D]||0),0)||1,B=Object.fromEntries(_.map(u=>[u,(p[u]||0)/F])),R=Object.fromEntries(_.map(u=>[u,B[u]*6])),se=[h.calendar||"solar",`${h.year}-${h.month}-${h.day}`,`${A(U(h.hour)??12)}:${A(Number(h.minute||0))}`,h.gender||"",E?.day?.stem||""].join("|"),oe=`lotto5-weighted|${K}|${se}`,q=[];for(let u=1;u<=5;u++){const D=je(ye(`${oe}|G${u}`));q.push(ke(D,p))}o(q);const le=Object.entries(P).sort((u,D)=>u[1]-D[1]).map(([u])=>u),ie=Object.entries(S).sort((u,D)=>D[1]-u[1]).map(([u])=>u);m({baseWeights:p,probs:B,expected:R,myCounts:P,todayCounts:S,dm:O,strength:a,weakestOrder:le,todayTop:ie,yongEls:w})},[K]),x.useEffect(()=>{if(M||typeof window>"u")return;const l=Me(I.current),y=Array.from(new Set([l,window])).filter(Boolean),v=Math.max(48,Math.round((window.innerHeight||0)*.08)),{scrollTop:S}=G(l||null);Y.current=S,H.current=!1;const h=a=>{const{clientHeight:w,scrollHeight:p}=G(a===window?null:a);return p-w>80},E=a=>{if(C.current||!H.current||!h(a)||V())return;const{scrollTop:w,clientHeight:p,scrollHeight:F}=G(a===window?null:a);w+p>=F-v&&(C.current=!0,X(),$(!0))};let z=!1;const T=()=>{z||(z=!0,requestAnimationFrame(()=>{z=!1;const{scrollTop:a,clientHeight:w,scrollHeight:p}=G(l||null),F=Math.abs(a-Y.current),B=p>0?(a+w)/p:0;!H.current&&(F>=ge||B>=be)&&(H.current=!0);for(const R of y)if(E(R),C.current)break}))},P=()=>{if(!(!H.current||C.current)){for(const a of y)if(E(a),C.current)break}};for(const a of y)a.addEventListener("scroll",T,{passive:!0});window.addEventListener("resize",P);const O=[];if("IntersectionObserver"in window){const a=W?.current;if(a){const w=p=>new IntersectionObserver(F=>{F.some(R=>R.isIntersecting)&&!C.current&&H.current&&h(p)&&!V()&&(C.current=!0,X(),$(!0),O.forEach(R=>R.disconnect()))},{root:p===window?null:p,threshold:1,rootMargin:"0px"});l&&O.push(w(l)),O.push(w(window)),O.forEach(p=>p.observe(a))}}return()=>{for(const a of y)a.removeEventListener("scroll",T);window.removeEventListener("resize",P),O.forEach(a=>a.disconnect())}},[M]),M?r.jsx("section",{className:"calculator","aria-label":"안내",children:r.jsx(ae,{homeHref:"/"})}):r.jsxs("section",{ref:I,className:"calculator","aria-label":`${e} 페이지`,children:[r.jsxs("div",{className:"card result",children:[r.jsx("h2",{children:e}),(d||j)&&r.jsxs("div",{className:"row cols-2 sm-cols-1",style:{marginTop:16},children:[r.jsxs("section",{style:{display:"grid",gap:8},children:[r.jsx("h3",{className:"h4",style:{margin:0},children:"내 사주 기둥"}),d?r.jsx(Q,{pillars:d,idPrefix:"my"}):r.jsx("p",{className:"muted",style:{margin:0},children:"내 정보가 없어 표시할 수 없습니다."})]}),r.jsxs("section",{style:{display:"grid",gap:8},children:[r.jsx("h3",{className:"h4",style:{margin:0},children:"오늘 사주 기둥 (정오 기준)"}),j?r.jsx(Q,{pillars:j,idPrefix:"today"}):r.jsx("p",{className:"muted",style:{margin:0},children:"오늘 기둥 계산에 실패했습니다."})]})]}),r.jsx("div",{className:"per-game",style:{marginTop:12},children:t.map((l,y)=>r.jsxs("div",{className:"chips-line",children:[r.jsxs("span",{className:"chip-badge","aria-hidden":!0,children:["G",y+1]}),r.jsx("div",{className:"chips",role:"list","aria-label":`게임 ${y+1} 번호`,children:l.main.map(v=>{const S=l.mapping[v]||Oe(v);return r.jsxs("span",{className:"chip",role:"listitem","aria-label":`번호 ${v} • ${S}`,children:[r.jsx("b",{children:String(v).padStart(2,"0")}),r.jsx("i",{className:`ball ${te(S)}`,"aria-hidden":!0,children:S})]},`n-${y}-${v}`)})})]},`pg-${y}`))}),r.jsxs("div",{className:"info-box",style:{marginTop:12},children:[r.jsx("div",{className:"mini-title",children:"오행 가중치·확률표 (초기 기준)"}),r.jsxs("div",{className:"prob-wrap",children:[r.jsxs("table",{className:"prob-table","aria-label":"오행 가중치 확률표",children:[r.jsx("thead",{children:r.jsxs("tr",{children:[r.jsx("th",{children:"오행"}),r.jsx("th",{children:"번호 범위"}),r.jsx("th",{children:"가중치"}),r.jsx("th",{children:"확률"}),r.jsx("th",{children:"예상 개수 (6개 중)"})]})}),r.jsx("tbody",{children:_.map(l=>r.jsxs("tr",{children:[r.jsx("td",{className:`elname ${te(l)}`,children:l}),r.jsx("td",{children:l==="목"?"1–9":l==="화"?"10–18":l==="토"?"19–27":l==="금"?"28–36":"37–45"}),r.jsx("td",{children:n?b(n.baseWeights[l]):"0.00"}),r.jsx("td",{children:n?`${b((n.probs[l]||0)*100)}%`:"0.00%"}),r.jsx("td",{children:n?b(n.expected[l]):"0.00"})]},`row-${l}`))}),r.jsx("tfoot",{children:r.jsxs("tr",{children:[r.jsx("td",{colSpan:2,children:"합계"}),r.jsx("td",{children:n?b(_.reduce((l,y)=>l+(n.baseWeights[y]||0),0)):"0.00"}),r.jsx("td",{children:"100.00%"}),r.jsx("td",{children:"6.00"})]})})]}),r.jsxs("p",{className:"helper",style:{marginTop:6},children:["* 표는 ",r.jsx("em",{children:"초기 확률"}),"을 나타냅니다. 실제 추출 중에는 같은 오행 반복을 줄이기 위해 선택 직후 해당 오행 가중치가 감쇄(×0.88)되어 결과가 다소 달라질 수 있습니다."]})]})]}),r.jsxs("div",{className:"info-box",style:{marginTop:12},children:[r.jsx("strong",{style:{display:"block",marginBottom:8},children:"왜 이 숫자인가요?"}),r.jsxs("ul",{className:"why-list",children:[r.jsxs("li",{children:[r.jsx("b",{children:"가중치(Weights)"}),"는 내 사주 오행 분포(간·지·장간)에서 상대적으로 부족한 오행을 보정하고, 일간(",n?.dm||"—",")의 상태(",n?.strength?.level||"—",")에 따라",n?.strength?.level==="신약"?" 인성·식상을 가산":n?.strength?.level==="신강"?" 재성·관성을 가산":" 순환 항목을 소폭 가산","했으며, 오늘(정오) 사주의 강한 오행(",n?.todayTop?.slice(0,2).join(", ")||"—",")과",n?.yongEls?.length?` 용신(${n.yongEls.join(", ")})`:" ","에 소폭 가점을 더했습니다."]}),n?.myCounts&&r.jsxs("li",{children:[r.jsx("b",{children:"내 오행 분포"})," (간·지·장간): 목 ",b(n.myCounts?.목),", 화 ",b(n.myCounts?.화),", 토 ",b(n.myCounts?.토),", 금 ",b(n.myCounts?.금),", 수 ",b(n.myCounts?.수),n?.weakestOrder?r.jsxs(r.Fragment,{children:[" · ",r.jsx("em",{children:"부족순:"})," ",n.weakestOrder.join(" → ")," "]}):null]}),r.jsxs("li",{children:[r.jsx("b",{children:"오늘 오행 분포"})," (정오 기준): 목 ",b(n?.todayCounts?.목??0),", 화 ",b(n?.todayCounts?.화??0),", 토 ",b(n?.todayCounts?.토??0),", 금 ",b(n?.todayCounts?.금??0),", 수 ",b(n?.todayCounts?.수??0)]}),r.jsxs("li",{children:[r.jsx("b",{children:"추출 로직"}),": 오행을 확률적으로 선택→해당 오행의 번호군(목 1–9, 화 10–18, 토 19–27, 금 28–36, 수 37–45)에서 중복 없이 6개 추출(선택된 오행은 감쇄×0.88로 편중 억제)."]})]})]}),r.jsx("div",{ref:W,style:{height:1}})]}),N&&r.jsx(fe,{isOpen:N,onClose:()=>$(!1),pageTitle:e,shareText:"내용이 도움이 되셨다면 지금 공유해보시겠어요?"}),r.jsx("style",{children:`
        .muted{ color: var(--ink-soft,#6b7280); }

        .per-game .chips-line{ display:flex; align-items:center; gap:10px; padding: 6px 0; }
        .chip-badge{
          padding: 3px 8px; border:1px solid var(--border,#e5e7eb); border-radius:999px;
          font-size: 12px; background: var(--surface,#fff); color:var(--ink-soft,#6b7280); flex: none;
        }
        .chips{ display:grid; grid-template-columns: repeat(6, minmax(0, 1fr)); gap:8px; width:100%; }
        .chip{
          display:flex; align-items:center; justify-content:center; gap:8px;
          padding:10px 12px; border:1px solid var(--border,#e5e7eb); border-radius:12px; background:var(--surface,#fff);
          min-width:0; white-space: nowrap;
        }
        .chip b{ font-size:16px; letter-spacing:0.02em; line-height:1; }

        .ball{
          display:inline-flex; align-items:center; justify-content:center;
          width:22px; height:22px; border-radius:999px; line-height:1;
          font-style:normal; font-weight:800; font-size:12px;
          border:1px solid var(--border,#e5e7eb);
          background:var(--muted,#f3f4f6); color:var(--ink-soft,#6b7280);
          user-select:none;
        }

        .ball.el-wood, .elname.el-wood{ color:#166534; background:#E8F5E9; border-color:#BFE7CC; }
        .ball.el-fire, .elname.el-fire{ color:#7F1D1D; background:#FEE2E2; border-color:#FBC6C6; }
        .ball.el-earth, .elname.el-earth{ color:#713F12; background:#FEF3C7; border-color:#F3E2A6; }
        .ball.el-metal, .elname.el-metal{ color:#1F2937; background:#E5E7EB; border-color:#D1D5DB; }
        .ball.el-water, .elname.el-water{ color:#1E3A8A; background:#DBEAFE; border-color:#BFDBFE; }

        .info-box{ border:1px solid var(--border,#e5e7eb); border-radius:12px; padding:12px; background:var(--surface,#fff); }
        .why-list{ list-style:none; padding-left:0; margin:8px 0 0; }
        .why-list li{ margin:6px 0; line-height:1.6; color:var(--ink); }

        .prob-wrap{ margin-top:6px; overflow:auto; }
        .prob-table{ width:100%; border-collapse: collapse; font-size:14px; }
        .prob-table th, .prob-table td{ border:1px solid var(--border,#e5e7eb); padding:8px 10px; text-align:center; }
        .prob-table thead th{ background:var(--muted,#f9fafb); font-weight:800; }
        .prob-table tfoot td{ background:var(--muted,#fafafa); font-weight:700; }

        @media (max-width: 640px){
          .per-game .chips-line{ gap: clamp(6px, 1.6vw, 10px); }
          .chips{ gap: clamp(4px, 1.4vw, 8px); }
          .chip{ padding: clamp(5px, 1.4vw, 10px) clamp(6px, 1.8vw, 12px); gap: clamp(3px, 1.2vw, 8px); }
          .chip b{ font-size: clamp(11px, 3.2vw, 16px); }
          .ball{ width: clamp(14px, 4.2vw, 22px); height: clamp(14px, 4.2vw, 22px); font-size: clamp(8px, 2.6vw, 12px); }
          .prob-table{ font-size: 13px; }
          .prob-table th, .prob-table td{ padding:6px 8px; }
        }
        @media (max-width: 380px){ .chips{ grid-template-columns: repeat(3, minmax(0, 1fr)); } }
        @media (max-width: 320px){
          .chips{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .chip{ padding: 3px 6px; gap: 2px; }
          .chip b{ font-size: 10px; }
          .ball{ width: 12px; height: 12px; font-size: 7px; }
          .prob-table{ font-size: 12px; }
        }
      `})]})};export{De as default};
