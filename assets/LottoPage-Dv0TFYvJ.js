import{r as g,j as t,I as ee}from"./index-DS_sG9kT.js";import{s as te,P as I,S as re,c as Q}from"./ShareModal-BT51Nhf0.js";import{a as ne,f as se,k as U,m as W}from"./cookieUtils-CFysK1LU.js";import{c as Y,g as oe,i as le}from"./sajuExtras-BqCxV7yX.js";function H(e){return String(e).padStart(2,"0")}function V(){const e=new Date(Date.now()+324e5);return{y:e.getUTCFullYear(),m:e.getUTCMonth()+1,d:e.getUTCDate()}}function ie(){const e=V();return`${e.y}-${H(e.m)}-${H(e.d)}`}const ae=120,ce=.6;function de(e){let r=2166136261;for(let o=0;o<e.length;o++)r^=e.charCodeAt(o),r=Math.imul(r,16777619);return r>>>0}function ue(e){return function(){let r=(e+=1831565813)>>>0;return r=Math.imul(r^r>>>15,r|1),r^=r+Math.imul(r^r>>>7,r|61),((r^r>>>14)>>>0)/4294967296}}const P={목:Array.from({length:9},(e,r)=>1+r),화:Array.from({length:9},(e,r)=>10+r),토:Array.from({length:9},(e,r)=>19+r),금:Array.from({length:9},(e,r)=>28+r),수:Array.from({length:9},(e,r)=>37+r)},k=["목","화","토","금","수"],he=e=>k[(k.indexOf(e)+4)%5],K=e=>k[(k.indexOf(e)+1)%5],pe=e=>k[(k.indexOf(e)+2)%5],q=e=>k[(k.indexOf(e)+3)%5];function fe(e){if(!e)return null;if(e?.sajuResult?.year&&e?.sajuResult?.month&&e?.sajuResult?.day&&e?.sajuResult?.hour)return e;const r=e.calendar||"solar",o=Number(e.year),n=Number(e.month),h=Number(e.day),i=Number(e.hour??0),m=Number(e.minute??0),d=e.leapMonth==="leap"||e.isLeap===!0;let a,l,p;if(typeof e.solarDate=="string"){const f=String(e.solarDate).match(/^(\d{4})-(\d{1,2})-(\d{1,2})$/);f&&(a=Number(f[1]),l=Number(f[2]),p=Number(f[3]))}if(!a||!l||!p)if(r==="lunar"){const f=se(o,n,h,d),E=f instanceof Date?f:new Date(f);a=E.getFullYear(),l=E.getMonth()+1,p=E.getDate()}else a=o,l=n,p=h;const M=Q(a,l,p,i,m);return{...e,calendar:r,solarDate:`${a}-${H(l)}-${H(p)}`,sajuResult:M,year:o,month:n,day:h,hour:i,minute:m}}function me(){const e=V();return Q(e.y,e.m,e.d,12,0)}function xe(e,r){const o=Object.entries(r).filter(([,i])=>i>0),n=o.reduce((i,[,m])=>i+m,0);if(!o.length||n<=0)return null;let h=e()*n;for(const[i,m]of o){if(h<m)return i;h-=m}return o[o.length-1][0]}function ge(e,r,o,n){const h=(e.목+e.화+e.토+e.금+e.수)/5,i={목:Math.max(0,h-(e.목||0)),화:Math.max(0,h-(e.화||0)),토:Math.max(0,h-(e.토||0)),금:Math.max(0,h-(e.금||0)),수:Math.max(0,h-(e.수||0))};if(r){const d=(a,l)=>i[a]=Math.max(0,(i[a]||0)+l);o.level==="신약"?(d(he(r),1),d(K(r),.35),d(r,.25)):o.level==="신강"?(d(q(r),.85),d(pe(r),.35),i[r]=Math.max(0,(i[r]||0)-.25)):(d(K(r),.15),d(q(r),.15))}const m=.25;return["목","화","토","금","수"].forEach(d=>{const a=(n[d]||0)*m;i[d]=Math.max(0,(i[d]||0)+a)}),i}function be(e){return e>=1&&e<=9?"목":e>=10&&e<=18?"화":e>=19&&e<=27?"토":e>=28&&e<=36?"금":e>=37&&e<=45?"수":""}function J(e){switch(e){case"목":return"el-wood";case"화":return"el-fire";case"토":return"el-earth";case"금":return"el-metal";case"수":return"el-water";default:return""}}function we(e,r){const o={목:[...P.목],화:[...P.화],토:[...P.토],금:[...P.금],수:[...P.수]},n=new Set,h=[],i={},m=Object.entries(r).sort((a,l)=>l[1]-a[1]).map(([a])=>a),d={...r};for(let a=0;a<6;a++){let l=xe(e,d)||m[a%m.length];d[l]=Math.max(0,(d[l]||0)*.88);let p=null,M=0;for(;M++<16;){if(!o[l]?.length){const C=Object.keys(o).filter(N=>o[N].length>0);if(!C.length)break;l=C[Math.floor(e()*C.length)]}const f=Math.floor(e()*o[l].length),E=o[l][f];if(!n.has(E)){p=E,o[l].splice(f,1);break}}p!=null&&(n.add(p),h.push(p),i[p]=l)}return h.sort((a,l)=>a-l),{main:h,mapping:i}}const z=["목","화","토","금","수"];function je(e){if(!e||typeof window>"u")return null;let r=e.parentElement;for(;r;){const o=window.getComputedStyle(r);if(/(auto|scroll|overlay)/.test(o.overflowY)||/(auto|scroll|overlay)/.test(o.overflow))return r;r=r.parentElement}return null}function _(e){if(e)return{scrollTop:e.scrollTop,clientHeight:e.clientHeight,scrollHeight:e.scrollHeight};const r=document.scrollingElement||document.documentElement;return{scrollTop:r.scrollTop,clientHeight:window.innerHeight||r.clientHeight,scrollHeight:r.scrollHeight}}const Se=()=>{const e="로또 숫자",[r,o]=g.useState([]),[n,h]=g.useState(null),[i,m]=g.useState(null),[d,a]=g.useState(null),[l,p]=g.useState(!1),[M,f]=g.useState(!1),E=g.useRef(null),C=g.useRef(null),N=g.useRef(!1),G=g.useRef(0),D=g.useRef(!1);return g.useEffect(()=>{te({title:`${e} | 운세뉴스`,description:"쿠키의 생년월일과 오늘 사주를 반영해 확률 가중 추출한 6/45 숫자(5세트).",path:"/#/lotto",image:"/og-image.png"})},[]),g.useEffect(()=>{let s=null;try{s=ne()}catch{}const b=!!(s&&s.hour!==""&&s.hour!==null&&s.hour!==void 0&&!Number.isNaN(Number(s.hour)));if(!s||!b){p(!0);return}p(!1);const v=me();a(v);const S=Y(v,{includeHidden:!1}),w=fe(s),T=w.sajuResult;m(T);const $=Y(T,{includeHidden:!0}),A=oe(T?.day?.stem),B=le(T),y=ge($,A,B,S),c=z.reduce((u,F)=>u+(y[F]||0),0)||1,j=Object.fromEntries(z.map(u=>[u,(y[u]||0)/c])),x=Object.fromEntries(z.map(u=>[u,j[u]*6])),R=[w.calendar||"solar",`${w.year}-${w.month}-${w.day}`,`${H(w.hour||0)}:${H(w.minute||0)}`,w.gender||"",T?.day?.stem||""].join("|"),L=`lotto5-weighted|${ie()}|${R}`,O=[];for(let u=1;u<=5;u++){const F=ue(de(`${L}|G${u}`));O.push(we(F,y))}o(O);const X=Object.entries($).sort((u,F)=>u[1]-F[1]).map(([u])=>u),Z=Object.entries(S).sort((u,F)=>F[1]-u[1]).map(([u])=>u);h({baseWeights:y,probs:j,expected:x,myCounts:$,todayCounts:S,dm:A,strength:B,weakestOrder:X,todayTop:Z})},[]),g.useEffect(()=>{if(l||typeof window>"u")return;const s=je(E.current),b=Array.from(new Set([s,window])).filter(Boolean),v=Math.max(48,Math.round((window.innerHeight||0)*.08)),{scrollTop:S}=_(s||null);G.current=S,D.current=!1;const w=c=>{const{clientHeight:j,scrollHeight:x}=_(c===window?null:c);return x-j>80},T=c=>{if(N.current||!D.current||!w(c)||U())return;const{scrollTop:j,clientHeight:x,scrollHeight:R}=_(c===window?null:c);j+x>=R-v&&(N.current=!0,W(),f(!0))};let $=!1;const A=()=>{$||($=!0,requestAnimationFrame(()=>{$=!1;const{scrollTop:c,clientHeight:j,scrollHeight:x}=_(s||null),R=Math.abs(c-G.current),L=x>0?(c+j)/x:0;!D.current&&(R>=ae||L>=ce)&&(D.current=!0);for(const O of b)if(T(O),N.current)break}))},B=()=>{if(!(!D.current||N.current)){for(const c of b)if(T(c),N.current)break}};for(const c of b)c.addEventListener("scroll",A,{passive:!0});window.addEventListener("resize",B);const y=[];if("IntersectionObserver"in window){const c=C?.current;if(c){const j=x=>new IntersectionObserver(R=>{R.some(O=>O.isIntersecting)&&!N.current&&D.current&&w(x)&&!U()&&(N.current=!0,W(),f(!0),y.forEach(O=>O.disconnect()))},{root:x===window?null:x,threshold:1,rootMargin:"0px"});s&&y.push(j(s)),y.push(j(window)),y.forEach(x=>x.observe(c))}}return()=>{for(const c of b)c.removeEventListener("scroll",A);window.removeEventListener("resize",B),y.forEach(c=>c.disconnect())}},[l]),l?t.jsx("section",{className:"calculator","aria-label":"안내",children:t.jsx(ee,{homeHref:"/"})}):t.jsxs("section",{ref:E,className:"calculator","aria-label":`${e} 페이지`,children:[t.jsxs("div",{className:"card result",children:[t.jsx("h2",{children:e}),t.jsxs("div",{className:"grid-two",style:{marginTop:4},children:[t.jsxs("div",{className:"mini-box",children:[t.jsx("div",{className:"mini-title",children:"내 사주 기둥"}),i?t.jsx(I,{pillars:i,sajuResult:i}):"—"]}),t.jsxs("div",{className:"mini-box",children:[t.jsx("div",{className:"mini-title",children:"오늘 사주 기둥 (정오 기준)"}),d?t.jsx(I,{pillars:d,sajuResult:d}):"—"]})]}),t.jsx("div",{className:"per-game",style:{marginTop:12},children:r.map((s,b)=>t.jsxs("div",{className:"chips-line",children:[t.jsxs("span",{className:"chip-badge","aria-hidden":!0,children:["G",b+1]}),t.jsx("div",{className:"chips",role:"list","aria-label":`게임 ${b+1} 번호`,children:s.main.map(v=>{const S=s.mapping[v]||be(v);return t.jsxs("span",{className:"chip",role:"listitem","aria-label":`번호 ${v} • ${S}`,children:[t.jsx("b",{children:String(v).padStart(2,"0")}),t.jsx("i",{className:`ball ${J(S)}`,"aria-hidden":!0,children:S})]},`n-${b}-${v}`)})})]},`pg-${b}`))}),t.jsxs("div",{className:"info-box",style:{marginTop:12},children:[t.jsx("strong",{style:{display:"block",marginBottom:8},children:"왜 이 숫자인가요?"}),t.jsxs("ul",{className:"why-list",children:[t.jsxs("li",{children:[t.jsx("b",{children:"가중치(Weights)"}),"는 내 사주 오행 분포(간·지·장간)에서 상대적으로 부족한 오행을 보정하고, 일간(",n?.dm||"—",")의 상태(",n?.strength?.level||"—",")에 따라",n?.strength?.level==="신약"?" 인성·식상을 가산":n?.strength?.level==="신강"?" 재성·관성을 가산":" 순환 항목을 소폭 가산","했으며, 오늘(정오) 사주의 강한 오행(",n?.todayTop?.slice(0,2).join(", ")||"—",")에 소폭 가점을 더했습니다."]}),n?.myCounts&&t.jsxs("li",{children:[t.jsx("b",{children:"내 오행 분포"})," (간·지·장간): 목 ",n.myCounts.목,", 화 ",n.myCounts.화,", 토 ",n.myCounts.토,", 금 ",n.myCounts.금,", 수 ",n.myCounts.수,n?.weakestOrder?t.jsxs(t.Fragment,{children:[" · ",t.jsx("em",{children:"부족순:"})," ",n.weakestOrder.join(" → ")]}):null]}),t.jsxs("li",{children:[t.jsx("b",{children:"오늘 오행 분포"})," (정오 기준): 목 ",n?.todayCounts?.목??0,", 화 ",n?.todayCounts?.화??0,", 토 ",n?.todayCounts?.토??0,", 금 ",n?.todayCounts?.금??0,", 수 ",n?.todayCounts?.수??0]}),t.jsxs("li",{children:[t.jsx("b",{children:"추출 로직"}),": 오행을 확률적으로 선택→해당 오행의 번호군(목 1–9, 화 10–18, 토 19–27, 금 28–36, 수 37–45)에서 중복 없이 6개 추출(선택된 오행은 감쇄×0.88로 편중 억제)."]})]}),t.jsxs("div",{className:"prob-wrap",children:[t.jsx("div",{className:"mini-title",children:"오행 가중치·확률표 (초기 기준)"}),t.jsxs("table",{className:"prob-table","aria-label":"오행 가중치 확률표",children:[t.jsx("thead",{children:t.jsxs("tr",{children:[t.jsx("th",{children:"오행"}),t.jsx("th",{children:"번호 범위"}),t.jsx("th",{children:"가중치"}),t.jsx("th",{children:"확률"}),t.jsx("th",{children:"예상 개수 (6개 중)"})]})}),t.jsx("tbody",{children:z.map(s=>t.jsxs("tr",{children:[t.jsx("td",{className:`elname ${J(s)}`,children:s}),t.jsx("td",{children:s==="목"?"1–9":s==="화"?"10–18":s==="토"?"19–27":s==="금"?"28–36":"37–45"}),t.jsx("td",{children:n?(n.baseWeights[s]||0).toFixed(2):"0.00"}),t.jsx("td",{children:n?`${((n.probs[s]||0)*100).toFixed(2)}%`:"0.00%"}),t.jsx("td",{children:n?(n.expected[s]||0).toFixed(2):"0.00"})]},`row-${s}`))}),t.jsx("tfoot",{children:t.jsxs("tr",{children:[t.jsx("td",{colSpan:2,children:"합계"}),t.jsx("td",{children:n?z.reduce((s,b)=>s+(n.baseWeights[b]||0),0).toFixed(2):"0.00"}),t.jsx("td",{children:"100.00%"}),t.jsx("td",{children:"6.00"})]})})]}),t.jsxs("p",{className:"helper",style:{marginTop:6},children:["* 표는 ",t.jsx("em",{children:"초기 확률"}),"을 나타냅니다. 실제 추출 중에는 같은 오행 반복을 줄이기 위해 선택 직후 해당 오행 가중치가 감쇄(×0.88)되어 결과가 다소 달라질 수 있습니다."]})]})]}),t.jsx("div",{ref:C,style:{height:1}})]}),M&&t.jsx(re,{isOpen:M,onClose:()=>f(!1),pageTitle:e,shareText:"내용이 도움이 되셨다면 지금 공유해보시겠어요?"}),t.jsx("style",{children:`
        .grid-two{ display:grid; grid-template-columns: 1fr 1fr; gap:10px; }
        @media (max-width: 640px){ .grid-two{ grid-template-columns: 1fr; } }
        .mini-box{ border:1px solid var(--border,#e5e7eb); border-radius:12px; padding:10px 12px; background:var(--surface,#fff); }
        .mini-title{ font-weight:700; font-size:14px; margin-bottom:6px; color: var(--ink-strong,#111827); }

        .per-game .chips-line{ display:flex; align-items:center; gap:10px; padding: 6px 0; }
        .chip-badge{
          padding: 3px 8px; border:1px solid var(--border,#e5e7eb); border-radius:999px;
          font-size: 12px; background: var(--surface,#fff); color:var(--ink-soft,#6b7280); flex: none;
        }
        .chips{ display:grid; grid-template-columns: repeat(6, minmax(0, 1fr)); gap:8px; width:100%; }
        .chip{
          display:flex; align-items:center; justify-content:center; gap:8px;
          padding:10px 12px; border:1px solid var(--border,#e5e7eb); border-radius:12px; background:var(--surface,#fff);
          min-width:0; white-space: nowrap;
        }
        .chip b{ font-size:16px; letter-spacing:0.02em; line-height:1; }

        .ball{
          display:inline-flex; align-items:center; justify-content:center;
          width:22px; height:22px; border-radius:999px; line-height:1;
          font-style:normal; font-weight:800; font-size:12px;
          border:1px solid var(--border,#e5e7eb);
          background:var(--muted,#f3f4f6); color:var(--ink-soft,#6b7280);
          user-select:none;
        }

        .ball.el-wood, .elname.el-wood{ color:#166534; background:#E8F5E9; border-color:#BFE7CC; }
        .ball.el-fire, .elname.el-fire{ color:#7F1D1D; background:#FEE2E2; border-color:#FBC6C6; }
        .ball.el-earth, .elname.el-earth{ color:#713F12; background:#FEF3C7; border-color:#F3E2A6; }
        .ball.el-metal, .elname.el-metal{ color:#1F2937; background:#E5E7EB; border-color:#D1D5DB; }
        .ball.el-water, .elname.el-water{ color:#1E3A8A; background:#DBEAFE; border-color:#BFDBFE; }

        .info-box{ border:1px solid var(--border,#e5e7eb); border-radius:12px; padding:12px; background:var(--surface,#fff); }
        .why-list{ list-style:none; padding-left:0; margin:8px 0 0; }
        .why-list li{ margin:6px 0; line-height:1.6; color:var(--ink); }

        .prob-wrap{ margin-top:10px; overflow:auto; }
        .prob-table{ width:100%; border-collapse: collapse; font-size:14px; }
        .prob-table th, .prob-table td{ border:1px solid var(--border,#e5e7eb); padding:8px 10px; text-align:center; }
        .prob-table thead th{ background:var(--muted,#f9fafb); font-weight:800; }
        .prob-table tfoot td{ background:var(--muted,#fafafa); font-weight:700; }

        @media (max-width: 640px){
          .per-game .chips-line{ gap: clamp(6px, 1.6vw, 10px); }
          .chips{ gap: clamp(4px, 1.4vw, 8px); }
          .chip{ padding: clamp(5px, 1.4vw, 10px) clamp(6px, 1.8vw, 12px); gap: clamp(3px, 1.2vw, 8px); }
          .chip b{ font-size: clamp(11px, 3.2vw, 16px); }
          .ball{ width: clamp(14px, 4.2vw, 22px); height: clamp(14px, 4.2vw, 22px); font-size: clamp(8px, 2.6vw, 12px); }
          .prob-table{ font-size: 13px; }
          .prob-table th, .prob-table td{ padding:6px 8px; }
        }
        @media (max-width: 380px){ .chips{ grid-template-columns: repeat(3, minmax(0, 1fr)); } }
        @media (max-width: 320px){
          .chips{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
          .chip{ padding: 3px 6px; gap: 2px; }
          .chip b{ font-size: 10px; }
          .ball{ width: 12px; height: 12px; font-size: 7px; }
          .prob-table{ font-size: 12px; }
        }
      `})]})};export{Se as default};
